<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Criar Currículo | Office Express</title>

  <!-- Ícones e fontes -->
  <link rel="icon" href="icon.png" type="image/png" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Estilos -->
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/style.css">

  <!-- Scripts externos -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/plugins/monthSelect/index.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.11.1/tsparticles.bundle.min.js"></script>

  <!-- Meta tags para compartilhamento -->
<meta property="og:title" content="Transforme sua história em oportunidades — Currículo em minutos">
<meta property="og:description" content="Você não é invisível. Mostre seu valor com um currículo que fala por você. Profissional, direto e feito pra quem está pronto pra ser escolhido(a).">
  <meta property="og:image" content="https://i.imgur.com/4YeH0xg.png">
  <meta property="og:url" content="https://officeexpress.onrender.com/curriculo.html">
  <meta property="og:type" content="website">
</head>

<body>
  <div id="particles-js"></div>

  <!-- Barra de progresso -->
  <div class="barra-progresso">
    <div id="progresso" class="progresso"></div>
  </div>

  <div id="notificacoes" style="margin-top: 10px; font-size: 0.95rem; color: #333; font-family: 'Inter', sans-serif;"></div>

  <div class="container">
    <h1>Construa o Currículo Que Vai Abrir Portas</h1>
    <form id="formulario">

      <!-- Etapa 1 -->
      <div class="etapa">
        <label for="foto">Sua Imagem Profissional <span style="font-weight: normal; color: #666;">(opcional, mas poderosa)</span></label>
        <div id="drop-area" style="display: flex; align-items: center; gap: 20px;">
          <div id="upload-box" style="flex: 1; padding: 20px; border: 2px dashed #ccc; border-radius: 10px; text-align: center; cursor: pointer;">
            <p>Arraste a foto aqui ou clique para selecionar</p>
            <input type="file" id="foto" accept="image/*" style="display: none;" />
          </div>
          <img id="preview-miniatura" src="" alt="Pré-visualização" style="width: 80px; height: 106px; object-fit: cover; border: 1px solid #ccc; border-radius: 6px; display: none;" />
          <div id="edit-icon" style="position: absolute; width: 80px; height: 106px; display: none; justify-content: center; align-items: center; pointer-events: none;">
            <img src="https://cdn-icons-png.flaticon.com/512/84/84380.png" alt="Editar" style="width: 32px; opacity: 0.5; pointer-events: auto; cursor: pointer;" onclick="abrirEditor()" />
          </div>
        </div>

<label>Seu Nome Completo <span style="font-weight: normal; color: #666;">(Como você quer ser lembrado)</span></label>
<div style="display: flex; align-items: center; gap: 10px;">
  <input type="text" name="nome" id="nome" required />
  <button type="button" onclick="reconhecerVoz('nome')" style="background: none; border: none; cursor: pointer;">
    <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
  </button>
</div>
        

      </div>

      <!-- Etapa 2A — Contato -->
<div class="etapa">
  <div style="display: flex; flex-direction: column; margin-bottom: 12px;">
    <label for="email">Email</label>
    <div style="display: flex; align-items: center; gap: 10px;">
      <input type="email" name="email" id="email" required />
    </div>
  </div>

  <label>Telefones</label>
  <div id="telefones">
    <input type="text" name="telefone[]" />
  </div>
  <button type="button" class="sub-botao" onclick="adicionarTelefone()">+ Adicionar Telefone</button>
</div>

<!-- Etapa 2B — Endereço -->
<div class="etapa">
  <div style="display: flex; flex-direction: column; margin-bottom: 12px;">
    <label for="endereco">Endereço (Rua)</label>
    <div style="display: flex; align-items: center; gap: 10px;">
      <input type="text" id="endereco" name="endereco" placeholder="Endereço completo" />
      <button type="button" onclick="reconhecerCampo('endereco')" style="background: none; border: none; cursor: pointer;">
        <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
      </button>
    </div>
  </div>

  <label>Número</label>
  <input type="text" name="numero" />

  <div style="display: flex; flex-direction: column; margin-bottom: 12px;">
    <label for="complemento">Complemento <span style="font-weight: normal; color: #666;">(opcional)</span></label>
    <div style="display: flex; align-items: center; gap: 10px;">
      <input type="text" name="complemento" id="complemento" />
      <button type="button" onclick="reconhecerCampo('complemento')" style="background: none; border: none; cursor: pointer;">
        <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
      </button>
    </div>
  </div>

  <div style="display: flex; flex-direction: column; margin-bottom: 12px;">
    <label for="bairro">Bairro</label>
    <div style="display: flex; align-items: center; gap: 10px;">
      <input type="text" name="bairro" id="bairro" />
      <button type="button" onclick="reconhecerCampo('bairro')" style="background: none; border: none; cursor: pointer;">
        <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
      </button>
    </div>
  </div>

  <div style="display: flex; flex-direction: column; margin-bottom: 12px;">
    <label for="cidade">Cidade</label>
    <div style="display: flex; align-items: center; gap: 10px;">
      <input type="text" name="cidade" id="cidade" />
      <button type="button" onclick="reconhecerCampo('cidade')" style="background: none; border: none; cursor: pointer;">
        <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
      </button>
    </div>
  </div>

  <label>CEP</label>
  <input type="text" name="cep" />
  <small style="display:block; margin-top:6px;">
    <a href="https://buscacepinter.correios.com.br/app/endereco/index.php" target="_blank" style="color:#00324a; text-decoration:underline;">
      Não sabe seu CEP? Clique aqui para buscar no site dos Correios
    </a>
  </small>
</div>

      <!-- Etapa 3 -->
      <div class="etapa">
  <label for="infoAdicional">Informações adicionais – algo que você gostaria de destacar?</label>
  <p style="margin-top: 10px; font-weight: 500; color: #555;">
    Compartilhe detalhes extras que possam fortalecer seu currículo, como disponibilidade, áreas de interesse ou conquistas relevantes.
  </p>
  <textarea name="infoAdicional" id="infoAdicional" rows="4" placeholder="Habilitação, disponibilidade, áreas de interesse, conquistas..."></textarea>

  <label style="margin-top: 30px;">Objetivo – o que você quer conquistar?</label>
  <p style="margin-top: 10px; font-weight: 500; color: #555;">
    Escreva com clareza o que você busca. Se estiver sem ideia, eu te ajudo a encontrar as palavras certas.
  </p>
  <textarea name="objetivo" required></textarea>

  <div id="ajuda-objetivo" style="margin-top: 30px;">
    <p style="font-weight: bold; font-size: 16px;">Está sem ideia de objetivo? <span style="color: #e09d00;">Eu te ajudo!</span></p>

    <label for="intuito">Qual é o seu foco?</label>
    <select id="intuito">
      <option value="">-- Escolha seu destino profissional --</option>
      <option value="emprego">Conseguir um emprego</option>
      <option value="estagio">Obter um estágio</option>
      <option value="promocao">Buscar promoção interna</option>
      <option value="freelance">Trabalhos freelance</option>
      <option value="transicao">Mudar de área</option>
    </select>

    <button id="gerarFrase" class="botao-personalizado">Gerar Objetivo</button>

    <div id="fraseGerada" style="margin-top: 10px; font-style: italic; color: #333;"></div>

    <button id="adicionarObjetivo" class="botao-personalizado">Adicionar</button>
  </div>
</div>

      <!-- Etapa 4 -->
      <div class="etapa">
        <h2>Seu Conhecimento é Seu Diferencial</h2>
<label>Cursos que moldaram sua jornada</label>
        <div id="cursos">
          <div class="curso">
<!-- Nome do curso -->
<div style="display: flex; flex-direction: column; margin-bottom: 12px;">
  <label for="curso">Nome do curso</label>
  <div style="display: flex; align-items: center; gap: 10px;">
    <input type="text" name="curso[]" id="curso" placeholder="Nome do curso" />
    <button type="button" onclick="reconhecerCampo('curso')" style="background: none; border: none; cursor: pointer;">
      <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
    </button>
  </div>
</div>

<!-- Instituição -->
<div style="display: flex; flex-direction: column; margin-bottom: 12px;">
  <div style="display: flex; align-items: center; gap: 10px;">
    <input type="text" name="instituicao[]" id="instituicao" placeholder="Instituição (opcional)" />
    <button type="button" onclick="reconhecerCampo('instituicao')" style="background: none; border: none; cursor: pointer;">
      <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
    </button>
  </div>
</div>
            <input type="text" name="carga[]" placeholder="Carga horária (ex: 40h)" class="carga-input" />
          </div>
        </div>
        <button type="button" class="sub-botao" onclick="adicionarCurso()">+ Adicionar Curso</button>
      </div>

      <!-- Etapa 5 -->
      <div class="etapa">
        <h2>Histórico de Conquistas</h2>
<label>Conte onde você já brilhou</label>
<div id="experiencias">
  <div class="experiencia">
    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
      <input type="text" name="empresa[]" id="empresa" placeholder="Empresa" />
      <button type="button" onclick="reconhecerCampo('empresa')" style="background: none; border: none; cursor: pointer;">
        <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
      </button>
    </div>

    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
      <input type="text" name="cargo[]" id="cargo" placeholder="Cargo" />
      <button type="button" onclick="reconhecerCampo('cargo')" style="background: none; border: none; cursor: pointer;">
        <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
      </button>
    </div>

    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
      <textarea name="atividades[]" id="atividades-texto" placeholder="Atividades desenvolvidas..."></textarea>
      <button type="button" onclick="reconhecerAtividades('atividades-texto')" style="background: none; border: none; cursor: pointer;">
        <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
      </button>
    </div>
  
            <label>Início:</label>
            <input type="text" class="mesAno" name="periodo_inicio[]" placeholder="Selecione mês e ano">
            <label>Fim:</label>
            <input type="text" class="mesAno" name="periodo_fim[]" placeholder="Selecione mês e ano">
          </div>
        </div>
        <button type="button" class="sub-botao" onclick="adicionarExperiencia()">+ Adicionar Experiência</button>
      </div>

      <!-- Etapa 6 -->
      <div class="etapa">
                <h2>O Que Te Torna Único</h2>
<label>Formação Acadêmica</label>
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
  <textarea name="formacao" id="formacao" required autocapitalize="sentences"></textarea>
  <button type="button" onclick="reconhecerCampo('formacao')" style="background: none; border: none; cursor: pointer;">
    <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
  </button>
</div>

<label>Habilidades</label>
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
  <textarea id="habilidades-texto" name="habilidades" placeholder="Ex: Comunicação, Liderança, Criatividade" autocapitalize="sentences"></textarea>
  <button type="button" onclick="reconhecerCampo('habilidades-texto')" style="background: none; border: none; cursor: pointer;">
    <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
  </button>
</div>

<label>Hobbies</label>
<div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
  <textarea id="hobbies-texto" name="hobbies" placeholder="Ex: Dançar, Ler, Praticar Exercícios" autocapitalize="sentences"></textarea>
  <button type="button" onclick="reconhecerCampo('hobbies-texto')" style="background: none; border: none; cursor: pointer;">
    <img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />
  </button>
</div>

        <p style="text-align: center; font-size: 1.1rem; margin-top: 30px; color: #00324a;">
Você está a um clique de transformar sua história profissional. <strong>Finalize e surpreenda-se com o resultado.</strong>
</p>
      </div>

      
      <!-- Navegação -->
<div class="navegacao" style="display: flex; justify-content: space-between; margin-top: 40px;">
  <button type="button" id="voltar" class="botao-navegacao">Voltar</button>
  <button type="button" id="avancar" class="botao-navegacao">Avançar</button>
</div>

  <script src="script.js"></script>

<script>
  const nomesUnicos = [
    "Adriana", "Aline", "Amanda", "Ana", "André", "Arthur", "Beatriz", "Bruna", "Caio", "Camila", "Carlos", "Carolina",
    "Cássia", "Cecília", "Clara", "Daniel", "Daniele", "Débora", "Diego", "Eduardo", "Eliane", "Elias", "Emerson", "Estela",
    "Fabiana", "Felipe", "Fernanda", "Flávia", "Gabriel", "Gisele", "Guilherme", "Helena", "Henrique", "Hugo", "Igor",
    "Isabela", "Joana", "João", "Jorge", "José", "Juliana", "Karina", "Larissa", "Leonardo", "Letícia", "Lucas", "Luiz",
    "Manuela", "Marcela", "Marcelo", "Marcos", "Maria", "Mariana", "Matheus", "Maurício", "Michele", "Milena", "Natália",
    "Nicole", "Patrícia", "Paula", "Pedro", "Priscila", "Rafael", "Raquel", "Renata", "Ricardo", "Roberta", "Rodrigo",
    "Rosa", "Samuel", "Sandra", "Sara", "Simone", "Sofia", "Sônia", "Stephanie", "Sueli", "Tainá", "Tatiane", "Thiago",
    "Valéria", "Vanessa", "Vinícius", "Viviane", "Vitor", "Yasmin", "Zuleica", "Alan", "Alessandra", "Alex", "Alice",
    "Almir", "Antônio", "Augusto", "Bárbara", "Benício", "Bernardo", "Bianca", "Bruno", "Caetano", "Calebe", "Carla",
    "Cassiano", "Catarina", "Celina", "César", "Cristiane", "Cristina", "Daniela", "Davi", "Denise", "Diana", "Diogo",
    "Domingos", "Dulce", "Edgar", "Edson", "Elaine", "Emanuel", "Erica", "Erick", "Ester", "Eunice", "Eva", "Evelyn",
    "Fabiano", "Fabrícia", "Fátima", "Fernando", "Flávio", "Francisca", "Francisco", "Frederico", "Geovana", "Geraldo",
    "Giovana", "Graziela", "Gustavo", "Heitor", "Heloísa", "Humberto", "Iara", "Ian", "Ieda", "Ilana", "Inês", "Irene",
    "Irineu", "Isabel", "Ivan", "Jacqueline", "Jaqueline", "Jessica", "Jonas", "Jonathan", "Jordana", "Joséfa", "Josué",
    "Júlia", "Juliano", "Jussara", "Karen", "Kelly", "Kleber", "Lara", "Laura", "Leandro", "Leda", "Lígia", "Lorena",
    "Lourdes", "Luana", "Luciana", "Luciano", "Lúcio", "Ludmila", "Luísa", "Magda", "Maicon", "Maíra", "Malu", "Marcílio",
    "Margarida", "Mariah", "Marilda", "Marina", "Marlene", "Marta", "Maurina", "Mayara", "Melissa", "Miguel", "Mirela",
    "Moacir", "Murilo", "Nádia", "Naiane", "Nara", "Natan", "Neide", "Nelson", "Neusa", "Ney", "Nícolas", "Noemi", "Norma",
    "Odair", "Olga", "Otávio", "Paloma", "Patrício", "Paulo", "Penélope", "Péricles", "Pietra", "Poliana", "Raimundo",
    "Regina", "Reinaldo", "Renan", "Rita", "Robson", "Rodnei", "Rogério", "Romário", "Rosana", "Rose", "Roseli", "Rubens",
    "Rute", "Sabrina", "Salete", "Samuel", "Sandra", "Sandro", "Sebastião", "Selma", "Sérgio", "Silvana", "Silvia",
    "Simão", "Solange", "Sueli", "Tadeu", "Talita", "Tamara", "Tatiana", "Telma", "Teresa", "Tiago", "Túlio", "Valdemar",
    "Valdir", "Valmir", "Vanda", "Vânia", "Vicente", "Vilma", "Vinicius", "Virgínia", "Vitor", "Vivian", "Wagner", "Walter",
    "Wellington", "Willian", "Yara", "Yuri", "Zélia", "Zenaide", "Zilda", "Zuleide"
  ];

  const acoes = ["Começou agora", "Está fazendo", "Terminou"];
  const nomesUsados = new Set();
  const tempos = [7000, 14000, 20000];
  let tempoIndex = 0;

  const container = document.getElementById("notificacoes");

  function gerarNotificacao() {
    if (nomesUsados.size >= nomesUnicos.length) return;

    let nome;
    do {
      nome = nomesUnicos[Math.floor(Math.random() * nomesUnicos.length)];
    } while (nomesUsados.has(nome));

    nomesUsados.add(nome);
    const acao = acoes[Math.floor(Math.random() * acoes.length)];
    const texto = `${nome} ${acao} o currículo.`;

    const div = document.createElement("div");
    div.classList.add("notificacao");
    div.textContent = texto;
    container.appendChild(div);

    const tempoAtual = tempos[tempoIndex];
    tempoIndex = (tempoIndex + 1) % tempos.length;

    setTimeout(() => {
      div.remove();
      gerarNotificacao();
    }, tempoAtual);
  }

  // Exibe primeiro a notificação com o nome do usuário
  const nomeUsuario = localStorage.getItem("nomeUsuario");
  if (nomeUsuario) {
    const div = document.createElement("div");
    div.classList.add("notificacao");
    div.textContent = `${nomeUsuario} começou agora o currículo.`;
    container.appendChild(div);
    nomesUsados.add(nomeUsuario);

    // Aguarda o tempo da primeira notificação antes de iniciar o ciclo
    setTimeout(() => {
      div.remove();
      gerarNotificacao();
    }, tempos[0]); // espera 7000ms antes de iniciar o ciclo
  } else {
    // Se não tiver nome, inicia direto
    gerarNotificacao();
  }
</script>
<script>
function limparPontuacaoFinal(texto) {
  // Remove qualquer pontuação no final da frase
  return texto.replace(/\s*[.,!?;:]$/, "").trim();
}

function capitalizarCadaPalavra(texto) {
  return texto
    .split(" ")
    .map(palavra => palavra.charAt(0).toUpperCase() + palavra.slice(1))
    .join(" ");
}

function limparPontuacaoFinal(texto) {
  return texto.replace(/\s*[.,!?;:]$/, "").trim();
}

// Capitaliza só a primeira letra da frase
function capitalizarPrimeiraLetra(texto) {
  return texto.charAt(0).toUpperCase() + texto.slice(1);
}

// Capitaliza cada palavra
function capitalizarCadaPalavra(texto) {
  return texto
    .split(" ")
    .map(palavra => palavra.charAt(0).toUpperCase() + palavra.slice(1))
    .join(" ");
}

// Remove pontuação final
function limparPontuacaoFinal(texto) {
  return texto.replace(/\s*[.,!?;:]$/, "").trim();
}

function reconhecerVoz(idCampo) {
  const campo = document.getElementById(idCampo);
  const reconhecimento = new (window.SpeechRecognition || window.webkitSpeechRecognition)();

  reconhecimento.lang = 'pt-BR';
  reconhecimento.interimResults = false;
  reconhecimento.maxAlternatives = 1;

  reconhecimento.start();

  reconhecimento.onresult = function(event) {
    let resultado = event.results[0][0].transcript;
    campo.value = resultado.trim();
  };

  reconhecimento.onerror = function(event) {
    console.error('Erro no reconhecimento de voz:', event.error);
    alert('Erro ao usar o microfone: ' + event.error);
  };
}

function reconhecerVoz(idCampo) {
  const campo = document.getElementById(idCampo);
  const reconhecimento = new (window.SpeechRecognition || window.webkitSpeechRecognition)();

  reconhecimento.lang = 'pt-BR';
  reconhecimento.interimResults = false;
  reconhecimento.maxAlternatives = 1;

  reconhecimento.start();

  reconhecimento.onresult = function(event) {
    let resultado = event.results[0][0].transcript;
    campo.value = resultado.trim();
  };

  reconhecimento.onerror = function(event) {
    console.error('Erro no reconhecimento de voz:', event.error);
    alert('Erro ao usar o microfone: ' + event.error);
  };
}

// Reconhecimento para campos comuns (capitaliza cada palavra)
function reconhecerCampo(idCampo) {
  const campo = document.getElementById(idCampo);
  const reconhecimento = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
  reconhecimento.lang = 'pt-BR';
  reconhecimento.interimResults = false;
  reconhecimento.maxAlternatives = 1;

  reconhecimento.start();

  reconhecimento.onresult = function(event) {
    let resultado = event.results[0][0].transcript;
    resultado = capitalizarCadaPalavra(limparPontuacaoFinal(resultado));
    campo.value = resultado;
  };

  reconhecimento.onerror = function(event) {
    alert('Erro no reconhecimento de voz: ' + event.error);
  };
}

// Reconhecimento exclusivo para atividades (capitaliza só a primeira letra)
function reconhecerAtividades(idCampo) {
  const campo = document.getElementById(idCampo);
  const reconhecimento = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
  reconhecimento.lang = 'pt-BR';
  reconhecimento.interimResults = false;
  reconhecimento.maxAlternatives = 1;

  reconhecimento.start();

  reconhecimento.onresult = function(event) {
    let resultado = event.results[0][0].transcript;
    resultado = capitalizarPrimeiraLetra(limparPontuacaoFinal(resultado));
    campo.value = resultado;
  };

  reconhecimento.onerror = function(event) {
    alert('Erro no reconhecimento de voz: ' + event.error);
  };
}

// Adiciona bloco de curso
function adicionarCurso() {
  const container = document.getElementById("cursos");
  const index = document.querySelectorAll(".curso-bloco").length;

  const div = document.createElement("div");
  div.className = "curso-bloco";
  div.style.marginBottom = "20px";

  const cursoLabel = document.createElement("label");
  cursoLabel.textContent = "Nome do curso";
  cursoLabel.setAttribute("for", `curso-${index}`);

  const cursoWrapper = document.createElement("div");
  cursoWrapper.style.display = "flex";
  cursoWrapper.style.alignItems = "center";
  cursoWrapper.style.gap = "10px";

  const cursoInput = document.createElement("input");
  cursoInput.type = "text";
  cursoInput.name = "curso[]";
  cursoInput.id = `curso-${index}`;
  cursoInput.placeholder = "Nome do curso";

  const cursoMic = document.createElement("button");
  cursoMic.type = "button";
  cursoMic.innerHTML = `<img src="https://i.imgur.com/xNcIv1O.png" alt="Microfone" style="width: 24px;" />`;
  cursoMic.style.background = "none";
  cursoMic.style.border = "none";
  cursoMic.style.cursor = "pointer";
  cursoMic.onclick = () => reconhecerCampo(`curso-${index}`);

  cursoWrapper.appendChild(cursoInput);
  cursoWrapper.appendChild(cursoMic);

  const instLabel = document.createElement("label");
  instLabel.setAttribute("for", `instituicao-${index}`);

  const instWrapper = document.createElement("div");
  instWrapper.style.display = "flex";
  instWrapper.style.alignItems = "center";
  instWrapper.style.gap = "10px";

  const instInput = document.createElement("input");
  instInput.type = "text";
  instInput.name = "instituicao[]";
  instInput.id = `instituicao-${index}`;
  instInput.placeholder = "Instituição (opcional)";

  const instMic = document.createElement("button");
  instMic.type = "button";
  instMic.innerHTML = `<img src="https://i.imgur.com/K0t5Kh1.png" alt="Microfone" style="width: 24px;" />`;
  instMic.style.background = "none";
  instMic.style.border = "none";
  instMic.style.cursor = "pointer";
  instMic.onclick = () => reconhecerCampo(`instituicao-${index}`);

  instWrapper.appendChild(instInput);
  instWrapper.appendChild(instMic);

  const cargaLabel = document.createElement("label");
  cargaLabel.setAttribute("for", `carga-${index}`);

  const cargaInput = document.createElement("input");
  cargaInput.type = "text";
  cargaInput.name = "carga[]";
  cargaInput.id = `carga-${index}`;
  cargaInput.placeholder = "Ex: 40 horas";

  div.appendChild(cursoLabel);
  div.appendChild(cursoWrapper);
  div.appendChild(instLabel);
  div.appendChild(instWrapper);
  div.appendChild(cargaLabel);
  div.appendChild(cargaInput);

  container.appendChild(div);
}

// Adiciona bloco de experiência
function adicionarExperiencia() {
  const container = document.getElementById("experiencias");
  const index = document.querySelectorAll(".experiencia").length;

  const div = document.createElement("div");
  div.className = "experiencia";
  div.style.marginBottom = "20px";

  const empresaWrapper = document.createElement("div");
  empresaWrapper.style.display = "flex";
  empresaWrapper.style.alignItems = "center";
  empresaWrapper.style.gap = "10px";
  empresaWrapper.style.marginBottom = "10px";

  const empresaInput = document.createElement("input");
  empresaInput.type = "text";
  empresaInput.name = "empresa[]";
  empresaInput.id = `empresa-${index}`;
  empresaInput.placeholder = "Empresa";

  const empresaMic = document.createElement("button");
  empresaMic.type = "button";
  empresaMic.innerHTML = `<img src="https://i.imgur.com/K0t5Kh1.png" alt="Microfone" style="width: 24px;" />`;
  empresaMic.style.background = "none";
  empresaMic.style.border = "none";
  empresaMic.style.cursor = "pointer";
  empresaMic.onclick = () => reconhecerCampo(`empresa-${index}`);

  empresaWrapper.appendChild(empresaInput);
  empresaWrapper.appendChild(empresaMic);

  const cargoWrapper = document.createElement("div");
  cargoWrapper.style.display = "flex";
  cargoWrapper.style.alignItems = "center";
  cargoWrapper.style.gap = "10px";
  cargoWrapper.style.marginBottom = "10px";

  const cargoInput = document.createElement("input");
  cargoInput.type = "text";
  cargoInput.name = "cargo[]";
  cargoInput.id = `cargo-${index}`;
  cargoInput.placeholder = "Cargo";

  const cargoMic = document.createElement("button");
  cargoMic.type = "button";
  cargoMic.innerHTML = `<img src="https://i.imgur.com/K0t5Kh1.png" alt="Microfone" style="width: 24px;" />`;
  cargoMic.style.background = "none";
  cargoMic.style.border = "none";
  cargoMic.style.cursor = "pointer";
  cargoMic.onclick = () => reconhecerCampo(`cargo-${index}`);

  cargoWrapper.appendChild(cargoInput);
  cargoWrapper.appendChild(cargoMic);

  const atividadesWrapper = document.createElement("div");
  atividadesWrapper.style.display = "flex";
  atividadesWrapper.style.alignItems = "center";
  atividadesWrapper.style.gap = "10px";
  atividadesWrapper.style.marginBottom = "10px";

  const atividadesTextarea = document.createElement("textarea");
  atividadesTextarea.name = "atividades[]";
  atividadesTextarea.id = `atividades-${index}`;
  atividadesTextarea.placeholder = "Atividades desenvolvidas...";

  const atividadesMic = document.createElement("button");
  atividadesMic.type = "button";
  atividadesMic.innerHTML = `<img src="https://i.imgur.com/K0t5Kh1.png" alt="Microfone" style="width: 24px;" />`;
  atividadesMic.style.background = "none";
  atividadesMic.style.border = "none";
  atividadesMic.style.cursor = "pointer";
  atividadesMic.onclick = () => reconhecerAtividades(`atividades-${index}`);

  atividadesWrapper.appendChild(atividadesTextarea);
  atividadesWrapper.appendChild(atividadesMic);

  const inicioLabel = document.createElement("label");
  inicioLabel.textContent = "Início:";

  const inicioInput = document.createElement("input");
  inicioInput.type = "text";
  inicioInput.className = "mesAno";
  inicioInput.name = "periodo_inicio[]";
  inicioInput.placeholder = "Selecione mês e ano";

  const fimLabel = document.createElement("label");
  fimLabel.textContent = "Fim:";

  const fimInput = document.createElement("input");
  fimInput.type = "text";
  fimInput.className = "mesAno";
  fimInput.name = "periodo_fim[]";
  fimInput.placeholder = "Selecione mês e ano";

  // Monta tudo
  div.appendChild(empresaWrapper);
  div.appendChild(cargoWrapper);
  div.appendChild(atividadesWrapper);
  div.appendChild(inicioLabel);
  div.appendChild(inicioInput);
  div.appendChild(fimLabel);
  div.appendChild(fimInput);

  container.appendChild(div);
}

fetch("https://officeexpress.onrender.com/api/logs", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    acao: "etapa",
    nome: localStorage.getItem("curriculo") ? JSON.parse(localStorage.getItem("curriculo")).nome : "visitante",
    etapa: "Digitando",
    timestamp: new Date().toISOString()
  })
});

</script>
<script>
let uploadEmAndamento = false;
(function () {
  const inicio = Date.now();
  const nome = JSON.parse(localStorage.getItem("curriculo"))?.nome || "visitante";
  let etapaAtual = "Digitando";
  let logEnviado = false;

  let entradaViaSplash = localStorage.getItem("entradaViaSplash") === "true";
  localStorage.removeItem("entradaViaSplash");

  let navegandoInternamente = localStorage.getItem("navegandoInternamente") === "true";
  localStorage.removeItem("navegandoInternamente");

  let rastreioLiberado = false;
  setTimeout(() => { rastreioLiberado = true }, 300);

  window.enviarLogAbandono = function () {
    if (logEnviado || !entradaViaSplash || navegandoInternamente) return;
    logEnviado = true;
    const tempo = Math.round((Date.now() - inicio) / 1000);
    fetch("https://officeexpress.onrender.com/api/logs", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        acao: "etapa",
        nome,
        etapa: `Abandonou ${etapaAtual} após ${tempo}s`,
        timestamp: new Date().toISOString()
      }),
      keepalive: true
    });
  };

window.handleVisibilityChange = function () {
  if (document.visibilityState === "hidden" && rastreioLiberado && !uploadEmAndamento) {
    enviarLogAbandono();
  }
};

  window.addEventListener("unload", enviarLogAbandono);
  document.addEventListener("visibilitychange", handleVisibilityChange);
})();
</script>


</body>
</html>