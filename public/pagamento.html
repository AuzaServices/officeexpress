<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>√öltima Chance | Office Express</title>
  <script src="https://cdn.jsdelivr.net/npm/tsparticles@2.11.1/tsparticles.bundle.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: linear-gradient(to right, #001f33, #00324a);
      font-family: 'Segoe UI', sans-serif;
    }
    .toast {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background-color: #ff8800;
      color: #00324a;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 0.95rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      opacity: 0;
      transition: opacity 0.5s ease;
      z-index: 9999;
    }
  </style>
</head>
<body class="relative py-20 px-4 text-white">
  <div id="particles-js" class="absolute inset-0 -z-10"></div>

  <section class="max-w-4xl mx-auto text-center">
<h2 class="text-5xl font-black mb-6 text-white/80 font-sans">
  CURR√çCULO <span class="text-[#ff8800]">PRONTO</span>
</h2>
<p class="text-xl text-white/80 mb-4">Voc√™ pode continuar sendo ignorado...</p>
<p class="text-2xl text-[#ff8800] font-bold mb-8">Ou pode AGIR AGORA e conquistar entrevistas com um curr√≠culo que realmente chama aten√ß√£o</p>

    <div class="bg-black/80 border border-[#E7C75F]/50 rounded-xl p-6 mb-8">
      <div class="flex justify-center items-center space-x-4 mb-4">
        <span class="text-3xl text-white/50 line-through">R$12,50</span>
        <span class="text-6xl font-black text-[#ff8800] font-['Anton'] animate-pulse">R$4,99</span>
      </div>
      <p class="text-green-400 font-semibold mb-2">HOJE APENAS</p>
      <p class="text-white/60 text-sm">Valor promocional para os primeiros 100 curr√≠culos gerados nesta semana</p>
    </div>

    <input type="text" id="pix" readonly
      class="w-full text-center font-bold text-[#0056b3] bg-[#eef6ff] border border-gray-300 rounded-lg py-3 mb-4"
      value="00020126640014BR.GOV.BCB.PIX0121andrielysom@gmail.com0217Curr√≠culo/An√°lise52040000530398654044.995802BR5925ANDRIELYSON DAVID NASCIME6009HORIZONTE62070503***63044F6F" />

    <button onclick="copiarPix()" class="w-full bg-[#E7C75F] text-black font-bold py-3 rounded-lg mb-6 hover:bg-green-600 hover:text-white transition">
      Copiar chave Pix
    </button>

    <button onclick="liberarPDF()" class="w-full bg-gradient-to-r from-[#E7C75F] to-[#d4b84a] text-black font-black text-xl py-4 rounded-lg hover:from-green-600 hover:to-green-700 hover:text-white transition transform hover:scale-105 shadow-2xl">
      ‚úÖ J√° paguei ‚Äî quero meu Curr√≠culo
    </button>

    <div id="pdf" class="mt-8 hidden">
<p class="text-lg mt-4">Parab√©ns! Seu curr√≠culo est√° pronto para abrir portas e gerar oportunidades reais.</p>
<a href="https://wa.me/5585991340658?text=Ol√°,%20j√°%20realizei%20o%20pagamento%20de%20R$4,99%20e%20quero%20receber%20meu%20curr√≠culo%20em%20PDF."
   target="_blank"
   class="block mt-4 bg-green-500 text-white font-bold py-3 rounded-lg hover:bg-green-600 transition">
  Receber agora pelo WhatsApp
</a>
    </div>

    <div class="mt-6 text-sm text-white/60 space-y-2">
<div class="mt-6 text-sm text-white/60 space-y-2">
  <div class="flex justify-center gap-4">
    <span>üîí Pagamento 100% seguro</span>
    <span>‚ö° Entrega imediata</span>
    <span>üõ°Ô∏è Garantia de satisfa√ß√£o por 7 dias</span>
  </div>
  <p class="mt-4">Mais de <span class="text-[#ff8800] font-bold">10.000 pessoas</span> j√° criaram seus curr√≠culos com a Office Express</p>
  <p class="text-red-400 font-bold">N√£o espere mais. Sua chance de ser chamado come√ßa com um curr√≠culo profissional.</p>
</div>
  </section>

  <footer class="mt-20 pt-8 text-center text-sm text-white/60">
    <p class="mt-4 text-[#E7C75F] font-bold">Office Express ¬© 2025 - Todos os direitos reservados</p>
  </footer>

  <script>
    function copiarPix() {
      const chave = document.getElementById("pix").value;
      navigator.clipboard.writeText(chave).then(() => {
        mostrarToast("Chave Pix copiada com sucesso!");
      });
    }

    function liberarPDF() {
      const btn = event.target;
      btn.innerText = "‚úÖ Pagamento confirmado!";
      btn.disabled = true;
      btn.style.backgroundColor = "#28a745";
      document.getElementById("pdf").style.display = "block";
    }

    function mostrarToast(mensagem) {
      const toast = document.createElement("div");
      toast.className = "toast";
      toast.innerText = mensagem;
      document.body.appendChild(toast);
      setTimeout(() => { toast.style.opacity = 1; }, 100);
      setTimeout(() => {
        toast.style.opacity = 0;
        setTimeout(() => toast.remove(), 500);
      }, 3000);
    }

    tsParticles.load("particles-js", {
      fullScreen: { enable: false },
      particles: {
        number: { value: 60 },
        color: { value: "#e09d00" },
        shape: { type: "circle" },
        opacity: { value: 0.3 },
        size: { value: 4 },
        move: {
          enable: true,
          speed: 1.5,
          direction: "none",
          outModes: { default: "bounce" }
        }
      },
      background: {
        color: { value: "transparent" }
      }
    });

    fetch("https://officeexpress.onrender.com/api/logs", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({
    acao: "etapa",
    nome: localStorage.getItem("curriculo") ? JSON.parse(localStorage.getItem("curriculo")).nome : "visitante",
    etapa: "Pagamento",
    timestamp: new Date().toISOString()
  })
});

  console.log("üìç Rastreamento iniciado");
  console.log("entradaViaSplash =", localStorage.getItem("entradaViaSplash"));
  console.log("navegandoInternamente =", localStorage.getItem("navegandoInternamente"));

  const inicio = Date.now();
  const nome = JSON.parse(localStorage.getItem("curriculo"))?.nome || "visitante";
  let etapaAtual = "Pagamento";
  let logEnviado = false;

  let entradaViaSplash = localStorage.getItem("entradaViaSplash") === "true";
  localStorage.removeItem("entradaViaSplash");

  let navegandoInternamente = localStorage.getItem("navegandoInternamente") === "true";
  localStorage.removeItem("navegandoInternamente");

  document.addEventListener("click", (e) => {
    const el = e.target.closest("a");
    if (el && el.href && el.href.includes(window.location.origin)) {
      navegandoInternamente = true;
      console.log("‚û°Ô∏è Navega√ß√£o interna detectada via clique");
    }
  });

  let rastreioLiberado = false;
  setTimeout(() => { rastreioLiberado = true }, 300);

  window.enviarLogAbandono = function () {
    if (logEnviado || !entradaViaSplash || navegandoInternamente) {
      console.log("‚õî Log bloqueado ‚Äî entradaViaSplash =", entradaViaSplash, "| navegandoInternamente =", navegandoInternamente);
      return;
    }

    logEnviado = true;
    const tempo = Math.round((Date.now() - inicio) / 1000);
    console.log("üö® Disparando log de abandono ap√≥s", tempo, "segundos");

    const payload = JSON.stringify({
      acao: "etapa",
      nome,
      etapa: `Abandonou ${etapaAtual} ap√≥s ${tempo}s`,
      timestamp: new Date().toISOString()
    });

    try {
      const blob = new Blob([payload], { type: "application/json" });
      const ok = navigator.sendBeacon("https://officeexpress.onrender.com/api/logs", blob);
      if (!ok) throw new Error("sendBeacon falhou");
    } catch (err) {
      console.warn("‚ö†Ô∏è sendBeacon falhou, tentando fetch como fallback");
      fetch("https://officeexpress.onrender.com/api/logs", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: payload,
        keepalive: true
      });
    }
  };

  window.handleVisibilityChange = function () {
    console.log("üëÄ visibilitychange =", document.visibilityState);
    if (document.visibilityState === "hidden" && rastreioLiberado) {
      enviarLogAbandono();
    }
  };

  window.addEventListener("unload", () => {
    console.log("üí• unload disparado");
    enviarLogAbandono();
  });

  document.addEventListener("visibilitychange", handleVisibilityChange);
  </script>

</body>
</html>